local requests = http_request or request
local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Plr = Players.LocalPlayer

local function invokeServer(...)
    return ReplicatedStorage.Remotes.CommF_:InvokeServer(...)
end

local args = {
    "Death Step",
    "Sharkman Karate",
    "Superhuman",
    "Dragon Talon",
    "Electric Claw",
    "Godhuman"
}

local PlaceIds = {
    [2753915549] = 1,
    [4442272183] = 2,
    [7449423635] = 3,
}

while wait(1) do
    local u = invokeServer("getInventory")
    local awak = invokeServer("getAwakenedAbilities")
    local ver = " V1"
    if invokeServer("Alchemist", "1") == -2 then
        ver = " V2"
    elseif invokeServer("Wenlocktoad", "1") == -2 then
        ver = " V3"
    elseif Plr.Backpack:FindFirstChild("Awakening") then
        if Plr.Character:FindFirstChild("Awakening") then
            ver = " V4"
        end
    end

    local Data = {
        Username = Plr.Name,
        Note = _G.Config.Note,
        discord_id = tonumber(_G.Config.discord_id),
        user_id = _G.Config.UserID,
        Melee = {},
        Fragments = tostring(Plr.Data.Fragments.Value),
        Beli = tostring(Plr.Data.Beli.Value),
        Bounty_Honor = tostring(Plr.leaderstats["Bounty/Honor"].Value),
        Level = tostring(Plr.Data.Level.Value),
        Sea = PlaceIds[game.PlaceId],
        Devil_Fruit = tostring(Plr.Data.DevilFruit.Value),
        Race = Plr.Data.Race.Value .. ver,
        LevelPulled = invokeServer("CheckTempleDoor"),
        Awakened_Skills = {},
        Guns = {},
        Materials = {},
        Swords = {},
        Accessories = {},
        Fruits = {}
    }

    for _, v in pairs(u) do
        if v.Type == "Sword" then
            table.insert(Data.Swords, v.Name)
        elseif v.Type == "Blox Fruit" then
            table.insert(Data.Fruits, v.Name)
        elseif v.Type == "Material" then
            table.insert(Data.Materials, string.format("x%s %s", tostring(v.Count), v.Name))
        elseif v.Type == "Gun" then
            table.insert(Data.Guns, v.Name)
        elseif v.Type == "Wear" then
            table.insert(Data.Accessories, v.Name)
        end
    end

    for _, v in pairs(args) do
        if invokeServer("Buy" .. string.gsub(v, " ", ""), true) == 1 then
            table.insert(Data.Melee, v)
        end
    end

    if awak then
        for i, v in pairs(awak) do
            if v.Awakened == true then
                table.insert(Data["Awakened_Skills"], i)
            end
        end
    end

    local a = requests({
        Url = "https://yummytrackstat.com/api/trackings",
        Method = "POST",
        Headers = {
            ["Content-Type"] = "application/json"
        },
        Body = HttpService:JSONEncode(Data)
    })
    print(HttpService:JSONEncode(a))
end
